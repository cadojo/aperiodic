<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Joe(y) Carpinelli</title>
<link>https://aperiodic.dev/blog/index.html</link>
<atom:link href="https://aperiodic.dev/blog/index.xml" rel="self" type="application/rss+xml"/>
<description></description>
<image>
<url>https://aperiodic.dev/images/orbits.webp</url>
<title>Joe(y) Carpinelli</title>
<link>https://aperiodic.dev/blog/index.html</link>
</image>
<generator>quarto-99.9.9</generator>
<lastBuildDate>Tue, 26 Oct 2021 00:00:00 GMT</lastBuildDate>
<item>
  <title>HORIZONS Scripting Interface</title>
  <dc:creator>Joe(y) Carpinelli</dc:creator>
  <link>https://aperiodic.dev/blog/posts/jpl-horizons-scripts.html</link>
  <description><![CDATA[ 




<div class="callout-note callout callout-style-simple">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>This tutorial describes an <a href="https://ssd.jpl.nasa.gov/horizons/manual.html#command-line">indefinitely supported</a>, yet obselete automated command-line interface to the JPL HORIZONS system. The recommended methods for automatically downloading JPL HORIZONS ephemeris data is the <a href="https://ssd.jpl.nasa.gov/horizons/app.html#/">graphical interface</a>, or the new <a href="https://ssd-api.jpl.nasa.gov/doc/horizons.html">REST API</a>.</p>
</div>
</div>
</div>
<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>NASA provides fantastic tools that are available for personal use – one such tool is NASA JPL’s <a href="https://ssd.jpl.nasa.gov/horizons.cgi">HORIZONS</a>. HORIZONS allows users to request positions, velocities, and physical attributes for thousands of bodies in our solar system. Users can request celestial body positions and velocities (often referred to as <em>ephemeris</em>) for several time steps. These orbital states are very accurately modeled! Ephemeris models often include relativistic effects, solar radiation pressure, aspherical bodies, and more. After receiving a <em>grid</em> of orbital states from HORIZONS, a user can <em>interpolate</em> between timesteps to find precise orbital states at any time.</p>
<p>HORIZONS has a <a href="https://ssd.jpl.nasa.gov/horizons.cgi">web interface</a>, and <a href="https://ssd.jpl.nasa.gov/?horizons">email and Telnet</a> interfaces. While the web interface is simple to use, it does not provide every capability offered by the email and Telnet interfaces. <strong>If you just want one ephemeris file for a specific use case, the web interface is probably ideal!</strong> While I’ve never used the email interface, I <em>have</em> used the Telnet interface – the Telnet interface can be invoked by entering <code>telnet://horizons.jpl.nasa.gov:6775</code> in a terminal of your choice. Otherwise, if you want to batch-request many ephemeris files, read on for a walkthrough for requesting ephemeris files from HORIZONS within a terminal, <em>without</em> manually walking through the Telnet interface!</p>
</section>
<section id="procedure" class="level2">
<h2 class="anchored" data-anchor-id="procedure">Procedure</h2>
<p>Rather than manually entering your desired ephemeris file attributes through HORIZONS’ web or Telnet interfaces, NASA JPL has provided open-source scripts for automatically fetching ephemeris data from JPL servers. The steps below provide all the information you need to use these scripts, and wrap them with a simple <code>.sh</code> script for ease of use.</p>
<p>Note that the rest of this walkthrough requires you use a terminal within a Unix-like system. If you want to use a Windows machine, consider using the <a href="https://docs.microsoft.com/en-us/windows/wsl/install">Windows Subsystem for Linux</a>.</p>
<p>If you follow the directions in this walkthrough verbatim, you’ll fetch a CSV-formatted ephemeris file without any text labels, with columns (from left to right): Julian day, X Position (km), Y Position (km), Z Position (km), X Velocity (km/s), Y Velocity (km/s), Z Velocity (km/s).</p>
<section id="install-dependencies" class="level3">
<h3 class="anchored" data-anchor-id="install-dependencies">Install Dependencies</h3>
<p>JPL’s scripts use <code>expect</code>, an automation tool, to interact with the HORIZONS Telnet interface (so you don’t have to). You will need both <code>expect</code> and <code>telnet</code> installed on your system. JPL’s output ephemeris files contain carriage return characters that are not expected by Unix-like systems. You can install and use <code>sponge</code> (often packaged with <code>moreutils</code>), as shown below, to help remove these carriage returns, and other extraneous information from the data files returned by HORIZONS. If you only wish to remove the carriage return characters, you can also simply open the output ephemeris file in <a href="https://code.visualstudio.com">VSCode</a> – this will re-format the file for your operating system.</p>
<p><em>Installing Dependencies on MacOS:</em></p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="co" style="color: #5E5E5E;"># Uses Homebrew, a MacOs package manager: https://brew.sh</span></span>
<span id="cb1-2"><span class="ex" style="color: null;">brew</span> install inetutils <span class="co" style="color: #5E5E5E;"># provides telnet</span></span>
<span id="cb1-3"><span class="ex" style="color: null;">brew</span> install expect    </span>
<span id="cb1-4"><span class="ex" style="color: null;">brew</span> install moreutils <span class="co" style="color: #5E5E5E;"># (optional) provides sponge</span></span></code></pre></div>
<p><em>Installing Dependencies on Ubuntu:</em></p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="co" style="color: #5E5E5E;"># Uses apt, the default Ubuntu package manager</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;">sudo</span> apt install telnet</span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;">sudo</span> apt install expect</span>
<span id="cb2-4"><span class="fu" style="color: #4758AB;">sudo</span> apt install moreutils <span class="co" style="color: #5E5E5E;"># (optional) provides sponge</span></span></code></pre></div>
<p>Installation on other systems (Debian, Arch, etc.) is likely very similar to the installation commands above.</p>
</section>
<section id="download-jpl-scripts" class="level3">
<h3 class="anchored" data-anchor-id="download-jpl-scripts">Download JPL Scripts</h3>
<p>JPL HORIZONS maintains scripts which users interact with through the command-line. See the HORIZONS <a href="https://ssd.jpl.nasa.gov/horizons/manual.html#command-line">documentation</a>, which states…</p>
<blockquote class="blockquote">
<p><em>The command-line interface can be automated. However, this is no longer recommended given the APIs introduced in 2021. Deprecated example scripts may be found in the FTP directory &lt;fhttps://ssd.jpl.nasa.gov/ftp/xfr/SCRIPTS/&gt; and will be supported indefinately.</em></p>
</blockquote>
<p>The script interface <a href="https://ssd.jpl.nasa.gov/ftp/ssd/SCRIPTS/README"><code>README</code></a> offers information about the existing scripts. Download and read through this file before continuing!</p>
<div class="callout-important callout callout-style-simple callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
You must verify you are permitted to download and use these scripts!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Refer to the HORIZONS <a href="https://ssd.jpl.nasa.gov/horizons/manual.html#command-line">documentation</a>, the command-line interface <a href="https://ssd.jpl.nasa.gov/ftp/ssd/SCRIPTS/README"><code>README</code></a>, and the script contents to determine if your usage and context forbids you from using these resources. The remainder of this tutorial assumes the user has read these instructions, and has determined they meet the qualifications for downloading and using all HORIZONS resources.</p>
</div>
</div>
<p>If you determine you are permitted, download the <code>vec_tbl</code> and <code>vec_tbl.inp</code> from JPL’s servers. The latter sets input parameters for your requested ephemeris data, the former is the ultimate script users can call to <em>get</em> ephemeris data. Remember to read their license –&nbsp;usage may not be free for commercial use, and text in each script file may state that some users are not permitted to download and use the scripts.</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;">wget</span> ftp://ssd.jpl.nasa.gov/pub/ssd/SCRIPTS/vec_tbl</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;">wget</span> ftp://ssd.jpl.nasa.gov/pub/ssd/SCRIPTS/vec_tbl.inp</span></code></pre></div>
<p>We’ll also need to make <code>vec_tbl</code> executable.</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="fu" style="color: #4758AB;">chmod</span> u+x vec_tbl</span></code></pre></div>
</section>
<section id="set-input-parameters" class="level3">
<h3 class="anchored" data-anchor-id="set-input-parameters">Set Input Parameters</h3>
<p>The input file, <code>vec_tbl.inp</code>, sets environment variables that <code>vec_tbl</code> uses to walk through the HORIZONS Telnet interface automatically. These parameters provide information like “where should the origin be placed” and “what time window, and what size timesteps should be returned”.</p>
<p>Edit <code>vec_tbl.inp</code> with your desired ephemeris file parameters. Some helpful parameter values are provided below – these parameters will result in an ephemeris format with the following attributes:</p>
<ul>
<li>Origin placed at solar system barycenter</li>
<li>CSV output with Cartesian coordinates</li>
<li>Time window from 2020 to 2070, with 6-hour increments</li>
<li>No text labels in the CSV data</li>
</ul>
<p>Note – you can replace <code>@ssb</code> with <code>@sun</code> to place the origin of the ephemeris data at the Sun’s center of mass.</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="bu" style="color: null;">set</span>   EMAIL_ADDR    <span class="st" style="color: #20794D;">"your_email_address@aol.net"</span> <span class="kw" style="color: #003B4F;">;</span></span>
<span id="cb5-2"><span class="bu" style="color: null;">set</span>   CENTER        <span class="st" style="color: #20794D;">"@ssb"</span>                       <span class="kw" style="color: #003B4F;">;</span></span>
<span id="cb5-3"><span class="bu" style="color: null;">set</span>   REF_PLANE     <span class="st" style="color: #20794D;">"FRAME"</span>                      <span class="kw" style="color: #003B4F;">;</span></span>
<span id="cb5-4"><span class="bu" style="color: null;">set</span>   START_TIME    <span class="st" style="color: #20794D;">"2020-Jan-1"</span>                 <span class="kw" style="color: #003B4F;">;</span></span>
<span id="cb5-5"><span class="bu" style="color: null;">set</span>   STOP_TIME     <span class="st" style="color: #20794D;">"2070-Jan-1"</span>                 <span class="kw" style="color: #003B4F;">;</span></span>
<span id="cb5-6"><span class="bu" style="color: null;">set</span>   STEP_SIZE     <span class="st" style="color: #20794D;">"6h"</span>                         <span class="kw" style="color: #003B4F;">;</span></span>
<span id="cb5-7"><span class="bu" style="color: null;">set</span>   CSV_FORMAT    <span class="st" style="color: #20794D;">"YES"</span>                        <span class="kw" style="color: #003B4F;">;</span></span>
<span id="cb5-8"><span class="bu" style="color: null;">set</span>   VEC_TABLE     <span class="st" style="color: #20794D;">"2"</span>                          <span class="kw" style="color: #003B4F;">;</span></span>
<span id="cb5-9"><span class="bu" style="color: null;">set</span>   REF_SYSTEM    <span class="st" style="color: #20794D;">"J2000"</span>                      <span class="kw" style="color: #003B4F;">;</span></span>
<span id="cb5-10"><span class="bu" style="color: null;">set</span>   VEC_CORR      <span class="st" style="color: #20794D;">"1"</span>                          <span class="kw" style="color: #003B4F;">;</span></span>
<span id="cb5-11"><span class="bu" style="color: null;">set</span>   OUT_UNITS     <span class="st" style="color: #20794D;">"1"</span>                          <span class="kw" style="color: #003B4F;">;</span></span>
<span id="cb5-12"><span class="bu" style="color: null;">set</span>   CSV_FORMAT    <span class="st" style="color: #20794D;">"YES"</span>                        <span class="kw" style="color: #003B4F;">;</span></span>
<span id="cb5-13"><span class="bu" style="color: null;">set</span>   VEC_LABELS    <span class="st" style="color: #20794D;">"NO"</span>                         <span class="kw" style="color: #003B4F;">;</span></span>
<span id="cb5-14"><span class="bu" style="color: null;">set</span>   VEC_DELTA_T   <span class="st" style="color: #20794D;">"NO"</span>                         <span class="kw" style="color: #003B4F;">;</span></span>
<span id="cb5-15"><span class="bu" style="color: null;">set</span>   VEC_TABLE     <span class="st" style="color: #20794D;">"2"</span>                          <span class="kw" style="color: #003B4F;">;</span></span></code></pre></div>
</section>
<section id="fetch-ephemeris-data" class="level3">
<h3 class="anchored" data-anchor-id="fetch-ephemeris-data">Fetch Ephemeris Data</h3>
<p>Now we can use <code>vec_tbl</code> to download Ephemeris data for any celestial body tracked by HORIZONS. The usage for <code>vec_tbl</code> is shown below.</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="ex" style="color: null;">./vec_tbl</span> <span class="op" style="color: #5E5E5E;">&lt;</span>BODY_ID<span class="op" style="color: #5E5E5E;">&gt;</span> <span class="op" style="color: #5E5E5E;">&lt;</span>OUTPUT_FILENAME<span class="op" style="color: #5E5E5E;">&gt;</span></span></code></pre></div>
<p>The second argument is the NAIF ID for the celestial body you’d like to track. IDs for common solar system bodies are provided in the table below.</p>
<table class="table">
<thead>
<tr class="header">
<th>Solar System Body</th>
<th>NAIF ID</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Mercury Barycenter</td>
<td>1</td>
</tr>
<tr class="even">
<td>Venus Barycenter</td>
<td>2</td>
</tr>
<tr class="odd">
<td>Earth-Moon Barycenter</td>
<td>3</td>
</tr>
<tr class="even">
<td>Mars Barycenter</td>
<td>4</td>
</tr>
<tr class="odd">
<td>Jupiter Barycenter</td>
<td>5</td>
</tr>
<tr class="even">
<td>Saturn Barycenter</td>
<td>6</td>
</tr>
<tr class="odd">
<td>Uranus Barycenter</td>
<td>7</td>
</tr>
<tr class="even">
<td>Neptune Barycenter</td>
<td>8</td>
</tr>
<tr class="odd">
<td>Pluto Barycenter</td>
<td>9</td>
</tr>
<tr class="even">
<td>Sun</td>
<td>10</td>
</tr>
<tr class="odd">
<td>Mercury</td>
<td>199</td>
</tr>
<tr class="even">
<td>Venus</td>
<td>299</td>
</tr>
<tr class="odd">
<td>Moon</td>
<td>301</td>
</tr>
<tr class="even">
<td>Earth</td>
<td>399</td>
</tr>
<tr class="odd">
<td>Mars</td>
<td>499</td>
</tr>
<tr class="even">
<td>Jupiter</td>
<td>599</td>
</tr>
<tr class="odd">
<td>Saturn</td>
<td>699</td>
</tr>
<tr class="even">
<td>Uranus</td>
<td>799</td>
</tr>
<tr class="odd">
<td>Neptune</td>
<td>899</td>
</tr>
<tr class="even">
<td>Pluto</td>
<td>999</td>
</tr>
</tbody>
</table>
<p>Note the output file will have a preamble, which includes physical characteristics of your selected celestial body, and other information.</p>
</section>
<section id="re-format-ephemeris-data-optional" class="level3">
<h3 class="anchored" data-anchor-id="re-format-ephemeris-data-optional">Re-format Ephemeris Data (optional)</h3>
<p>The output format of the Ephemeris file will depend on your input parameters provided in <code>vec_tbl.inp</code>. If you’re following this walk-through verbatim (aka using the input parameters provided above), then your output file will have 7 columns: Julian day, date-time label, X, Y, Z positions, X, Y, Z velocities. All columns are numeric, with the exception of column 2 – this makes loading data into MATLAB, Python, or Julia a bit more complicated. We don’t need column 2 to interpolate between Cartesian states, because column 2 is simply a plain-language description of the Julian Day value in column 1. We can use <code>sed</code> and <code>awk</code> magic to strip out the second column, and remove the preamble from the Ephemeris file. The <code>sed</code> and <code>awk</code> commands below are taken directly from the two StackOverflow answers: <a href="https://stackoverflow.com/a/38978201"><code>sed</code> reference</a>, <a href="https://unix.stackexchange.com/a/34686"><code>awk</code> reference</a>. Remember to replace <code>&lt;FILE&gt;</code> with your desired output file name!</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="co" style="color: #5E5E5E;"># Filter out data-file preamble</span></span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;">sed</span> <span class="at" style="color: #657422;">-n</span> <span class="st" style="color: #20794D;">'/\$\$SOE/,/\$\$EOE/{//!p;}'</span> <span class="op" style="color: #5E5E5E;">&lt;</span>FILE<span class="op" style="color: #5E5E5E;">&gt;</span> <span class="kw" style="color: #003B4F;">|</span> <span class="ex" style="color: null;">sponge</span> <span class="op" style="color: #5E5E5E;">&lt;</span>FILE<span class="op" style="color: #5E5E5E;">&gt;</span> </span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="co" style="color: #5E5E5E;"># Remove second column (data-time label)</span></span>
<span id="cb7-5"><span class="fu" style="color: #4758AB;">awk</span> <span class="at" style="color: #657422;">-F</span> , <span class="st" style="color: #20794D;">'BEGIN {OFS=FS}  {$2=""; sub(",,", ","); print}'</span> <span class="op" style="color: #5E5E5E;">&lt;</span>FILE<span class="op" style="color: #5E5E5E;">&gt;</span> <span class="kw" style="color: #003B4F;">|</span> <span class="ex" style="color: null;">sponge</span> <span class="op" style="color: #5E5E5E;">&lt;</span>FILE<span class="op" style="color: #5E5E5E;">&gt;</span> </span></code></pre></div>
<p>Now your file will have only comma-delimited rows of numbers!</p>


</section>
</section>

 ]]></description>
  <category>space</category>
  <category>ephemeris</category>
  <category>tutorial</category>
  <category>technical</category>
  <guid>https://aperiodic.dev/blog/posts/jpl-horizons-scripts.html</guid>
  <pubDate>Tue, 26 Oct 2021 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Introduction to Dynamics</title>
  <dc:creator>Joe(y) Carpinelli</dc:creator>
  <link>https://aperiodic.dev/blog/posts/introduction-to-dynamics.html</link>
  <description><![CDATA[ 




<section id="meta-title" class="level1">
<h1>Introduction to Dynamics</h1>
<p><em>An introduction to dynamics through scientific software.</em></p>
<div class="callout-note callout callout-style-simple callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Offprint
</div>
</div>
<div class="callout-body-container callout-body">
<p>This is a section from a control theory note-set I’m writing, <strong>Exploring Control Theory</strong>. It won’t be done for years! Over time, I’ll add chapters to the open-source repository, <a href="https://github.com/cadojo/controls" class="uri">https://github.com/cadojo/controls</a>. Some chapters that stand on their own will be added as blog posts <a href="../../blog/">here</a>!</p>
</div>
</div>
<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>Our end goal as controls engineers is to <em>affect</em> a system in some desired way. To do this, we’ll need a mathematical description of our system. This mathematical description is known as a <em>model</em>. There’s a famous <a href="https://en.wikipedia.org/wiki/All_models_are_wrong">quote</a> about mathematical models: “all models are wrong, but some are useful”.</p>
<p>This is really important. We are <strong>always</strong> approximating our system by describing it with a model. The question we need to ask is “is our approximate description of our system (our model) good enough?”</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Definitions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Model</strong>: a mathematical description of a system</li>
</ul>
</div>
</div>
<p>But what does this model <em>look like</em>? To answer this question, let’s first discuss system dynamics, and equations of motion.</p>
</section>
<section id="dynamics" class="level2">
<h2 class="anchored" data-anchor-id="dynamics">Dynamics</h2>
<p>If we want to <em>affect</em> a system, then by definition, the system <em>should</em> be affect-able (is that a word?) by external forces. These “forces” don’t necessarily need to be physical forces: consider the affect of introducing new predators in an ecosystem with the goal of affecting predator-prey populations.</p>
<p>So we have a mathematical description, and we know we’ll need some changing <em>parameter</em> to affect the mathematical description. Sounds like we need equations! The equations that govern our system are often called <em>equations of motion</em>. Any system that changes due to some external “force” is known as a <em>dynamical</em> system by definition.</p>
<p>The first step to any controls problem is identifying the <em>dynamics</em>; this usually means defining the <em>equations of motion</em> for our system. A set of <em>equations of motion</em> which describe our <em>dynamical</em> system <strong>is</strong> our model.</p>
</section>
<section id="example" class="level2">
<h2 class="anchored" data-anchor-id="example">Example</h2>
<p>A really common system in engineering is known as the <strong>spring-mass-damper</strong>. We can roughly describe this system as a block on a table, which is connected to a spring. We can <em>force</em> (a.k.a. <em>affect</em>) this system by pulling on the block to extend or compress the spring.</p>
<section id="model-construction" class="level3">
<h3 class="anchored" data-anchor-id="model-construction">Model Construction</h3>
<p>Let’s figure out our equations of motion. The following question is usually a useful starting point: “what are the forces on our system?” We know we’ll have one external force: us pulling or pushing on the block! Let’s call this external force <img src="https://latex.codecogs.com/png.latex?f_e">. We’ll also have a force due to the spring, and a force due to the friction between the block and the table. The force due to the spring will be <em>proportional</em> to the position of the block with respect to the spring’s neutral position: let’s call the spring constant <img src="https://latex.codecogs.com/png.latex?k">. The force due to friction will be proportional to the <em>velocity</em> of the block (let’s forget about static friction for now): let’s call the coefficient of friction <img src="https://latex.codecogs.com/png.latex?d">.</p>
<p>With all of the forces identified, we can start constructing the <em>eqautions of motion</em> for this system. If we call our block’s position <img src="https://latex.codecogs.com/png.latex?x">, then the acceleration <img src="https://latex.codecogs.com/png.latex?%5Cddot%7Bx%7D"> will be equal to the sum of our external force <img src="https://latex.codecogs.com/png.latex?f_e">, the spring force <img src="https://latex.codecogs.com/png.latex?k%20x">, and the force due to friction <img src="https://latex.codecogs.com/png.latex?d%20%5Cdot%7Bx%7D">. Summing these forces produces the following (common) spring-mass-damper equation, where <img src="https://latex.codecogs.com/png.latex?m"> is the mass of the block.</p>
<p><span id="eq-forced-mass-damper"><img src="https://latex.codecogs.com/png.latex?f_e%20=%20m%20%5Cddot%7Bx%7D%20+%20d%20%5Cdot%7Bx%7D%20+%20k%20x%20%5Ctag%7B1%7D"></span></p>
<p>We have our model! This is a second-order differential equation (Equation&nbsp;1). It helps to divide all variables into two groups: parameters, and states. States describe the system at some point in time. In this case, state variables answer the following questions: “where is the block, what is the velocity of the block, and what is the acceleration of the block?” One set of valid state variables for this system is <img src="https://latex.codecogs.com/png.latex?x"> and <img src="https://latex.codecogs.com/png.latex?%5Cdot%7Bx%7D">; we don’t need to include <img src="https://latex.codecogs.com/png.latex?%5Cddot%7Bx%7D"> in our list of state variables because we can calculate <img src="https://latex.codecogs.com/png.latex?%5Cddot%7Bx%7D"> from <img src="https://latex.codecogs.com/png.latex?x"> and <img src="https://latex.codecogs.com/png.latex?%5Cdot%7Bx%7D">.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We say “one set of state variables” because there may (and nearly always are) other valid state representations that could completely describe this system! State variables are <strong>not</strong> unique.</p>
</div>
</div>
<p>If we leave states as symbolic, and then look to the equation(s) of motion of a system, the <em>parameters</em> describe a specific <em>instance</em> of a system. Put another way, no matter what values <img src="https://latex.codecogs.com/png.latex?f_e">, <img src="https://latex.codecogs.com/png.latex?d">, and <img src="https://latex.codecogs.com/png.latex?k"> take, this equation of motion is identifiable as a spring-mass-damper. For this reason, we can specify <img src="https://latex.codecogs.com/png.latex?f_e">, <img src="https://latex.codecogs.com/png.latex?d">, and <img src="https://latex.codecogs.com/png.latex?k"> as parameters. We can assume a unit mass for the block for now.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The parameter <img src="https://latex.codecogs.com/png.latex?f_e"> is our <em>control</em> parameter in this example, because we can change <img src="https://latex.codecogs.com/png.latex?f_e"> to affect our system. For now, let’s not differentiate between control parameters and non-control parameters.</p>
</div>
</div>
</section>
<section id="coding-our-model" class="level3">
<h3 class="anchored" data-anchor-id="coding-our-model">Coding our Model</h3>
<p>We can simulate these dynamics with Julia’s <code>DifferentialEquations</code> package. If you’re familiar with MATLAB, <code>DifferentialEquations</code> provides numerical integration solvers that are similar to MATLAB’s <code>ode45</code> (and similar) solvers. We can use the <code>ModelingToolkit</code> package to conveniently put our model to code, and interface with <code>DifferentialEquations</code> for simulation.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><span class="im" style="color: #00769E;">using</span> <span class="bu" style="color: null;">ModelingToolkit</span>, <span class="bu" style="color: null;">DifferentialEquations</span>, <span class="bu" style="color: null;">Plots</span></span></code></pre></div>
</div>
<p>Now that we have access to <code>ModelingToolkit</code>, let’s build the model!</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><span class="pp" style="color: #AD0000;">@parameters</span> t fₑ d k</span>
<span id="cb2-2"><span class="pp" style="color: #AD0000;">@variables</span> <span class="fu" style="color: #4758AB;">x</span>(t) <span class="fu" style="color: #4758AB;">ẋ</span>(t)</span>
<span id="cb2-3">δ <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;">Differential</span>(t)</span>
<span id="cb2-4"></span>
<span id="cb2-5">eqs <span class="op" style="color: #5E5E5E;">=</span> [</span>
<span id="cb2-6">    <span class="fu" style="color: #4758AB;">δ</span>(x) <span class="op" style="color: #5E5E5E;">~</span> ẋ,</span>
<span id="cb2-7">    <span class="fu" style="color: #4758AB;">δ</span>(ẋ)<span class="op" style="color: #5E5E5E;">~</span> <span class="op" style="color: #5E5E5E;">-</span> d<span class="op" style="color: #5E5E5E;">*</span>ẋ <span class="op" style="color: #5E5E5E;">-</span> k<span class="op" style="color: #5E5E5E;">*</span>x <span class="op" style="color: #5E5E5E;">+</span> fₑ</span>
<span id="cb2-8">]</span>
<span id="cb2-9"></span>
<span id="cb2-10">model <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;">ODESystem</span>(eqs, t, [x, ẋ], [fₑ, d, k]; name <span class="op" style="color: #5E5E5E;">=</span> <span class="op" style="color: #5E5E5E;">:</span>HarmonicOscillator)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div class="ansi-escaped-output">
<pre><span class="ansi-bold">Model HarmonicOscillator with 2 </span><span class="ansi-bold">equations</span>
<span class="ansi-bold">States (2):</span>
  x(t)
  ẋ(t)
<span class="ansi-bold">Parameters (3):</span>
  fₑ
  d
  k</pre>
</div>
</div>
</div>
</section>
<section id="simulating-our-model" class="level3">
<h3 class="anchored" data-anchor-id="simulating-our-model">Simulating our Model</h3>
<p>With <code>model</code> defined above, we can use <code>DifferentialEquations</code> to simulate our system. Of course, to do this we’ll need to specify numerical values for our parameters, and initial conditions (the simulation starting point) for our state variables. The code below specifies some arbitrary initial conditions and constant parameter values, and simulates the resulting dynamics.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1">problem <span class="op" style="color: #5E5E5E;">=</span> <span class="kw" style="color: #003B4F;">let</span> x₀ <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0.1</span>, ẋ₀ <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0.0</span>, dₙ <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0.5</span>, kₙ <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0.9</span>, fₙ <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1.0</span>, Δt <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">30.0</span></span>
<span id="cb3-2">    <span class="fu" style="color: #4758AB;">ODEProblem</span>(</span>
<span id="cb3-3">        model,</span>
<span id="cb3-4">        [x <span class="op" style="color: #5E5E5E;">=&gt;</span> x₀, ẋ <span class="op" style="color: #5E5E5E;">=&gt;</span> ẋ₀],</span>
<span id="cb3-5">        (<span class="fl" style="color: #AD0000;">0.0</span>, Δt),</span>
<span id="cb3-6">        [d <span class="op" style="color: #5E5E5E;">=&gt;</span> dₙ, k <span class="op" style="color: #5E5E5E;">=&gt;</span> kₙ, fₑ <span class="op" style="color: #5E5E5E;">=&gt;</span> fₙ]</span>
<span id="cb3-7">    )</span>
<span id="cb3-8"><span class="kw" style="color: #003B4F;">end</span></span>
<span id="cb3-9"></span>
<span id="cb3-10">solutions <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;">solve</span>(problem, <span class="fu" style="color: #4758AB;">Tsit5</span>(); reltol <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1e-12</span>, abstol <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1e-12</span>)</span>
<span id="cb3-11"><span class="fu" style="color: #4758AB;">plot</span>(solutions; linewidth <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">2</span>, dpi <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">130</span>, title <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Spring Mass Damper Simulation"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<p><img src="https://aperiodic.dev/blog/posts/introduction-to-dynamics_files/figure-html/cell-5-output-1.svg" class="img-fluid"></p>
</div>
</div>


</section>
</section>
</section>

 ]]></description>
  <category>julia</category>
  <category>dynamics</category>
  <category>controls</category>
  <category>offprint</category>
  <category>technical</category>
  <guid>https://aperiodic.dev/blog/posts/introduction-to-dynamics.html</guid>
  <pubDate>Sun, 04 Jul 2021 00:00:00 GMT</pubDate>
</item>
</channel>
</rss>
